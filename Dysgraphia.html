<!DOCTYPE html>
<html lang="si">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡∂Ö‡∂ö‡∑î‡∂ª‡∑î ‡∂∏‡∑í‡∂≠‡∑î‡∂ª‡∑è</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Sinhala:wght@400;700&display=swap" rel="stylesheet">
<style>
body {
  font-family: 'Noto Sans Sinhala', sans-serif;
  margin:0; padding:0;
  background: radial-gradient(circle at top left, #fdfbfb, #ebedee, #d0f0fd, #a3e4fc);
  animation: bgAnim 15s infinite alternate;
  overflow-x:hidden;
}
@keyframes bgAnim {
  0%{background: radial-gradient(circle at top left, #fdfbfb, #ebedee, #d0f0fd, #a3e4fc);}
  50%{background: radial-gradient(circle at bottom right, #ffe6f0, #ffd3e0, #ffc0d0, #ffa0b0);}
  100%{background: radial-gradient(circle at center, #fdfbfb, #d0f0fd, #a3e4fc, #7fc8fa);}
}

header { background:#0077b6; color:white; padding:1rem; text-align:center; box-shadow:0 4px 6px rgba(0,0,0,0.2);}
nav { display:flex; justify-content:center; background:#023e8a; flex-wrap:wrap;}
nav a { color:white; text-decoration:none; padding:1rem; display:flex; align-items:center; gap:0.3rem; transition: transform 0.2s;}
nav a:hover { background:#0096c7; transform:scale(1.1);}
section { padding:2rem;}
h1,h2 { color:#023e8a;}
.letters { display:grid; grid-template-columns:repeat(6,1fr); gap:10px; margin-top:1rem;}
.letter { font-size:2rem; text-align:center; background:#fff; border:2px solid #0096c7; border-radius:10px; padding:10px; cursor:pointer; transition: transform 0.2s, background 0.2s;}
.letter:hover { background:#caf0f8; transform:scale(1.2);}
.game, .faq, .howto, .feedback { background:#fff; padding:1rem; margin:1rem 0; border-radius:15px; box-shadow:0 6px 12px rgba(0,0,0,0.15);}
footer { background:#023e8a; color:white; text-align:center; padding:1rem; margin-top:2rem;}
input, textarea { width:100%; padding:10px; margin:6px 0; border:1px solid #0096c7; border-radius:6px; font-family:inherit;}
button { background:#0077b6; color:white; border:none; padding:10px 20px; border-radius:6px; cursor:pointer; transition: transform 0.2s;}
button:hover { background:#0096c7; transform:scale(1.05);}
@media(max-width:768px){ .letters{ grid-template-columns:repeat(3,1fr); } }
.game-dashboard { display:grid; grid-template-columns: repeat(auto-fit, minmax(250px,1fr)); gap:1rem;}
.game-card { background: linear-gradient(135deg,#f9f9f9,#e0f7fa); border-radius:15px; padding:1rem; box-shadow:0 6px 12px rgba(0,0,0,0.15); text-align:center; transition: transform 0.3s, box-shadow 0.3s;}
.game-card:hover { transform: translateY(-5px) scale(1.03); box-shadow:0 10px 20px rgba(0,0,0,0.25);}
.game-card button { margin-top:8px; border-radius:8px; transition: transform 0.2s;}
.game-card button:hover { transform: scale(1.1); }
#voiceHistory li:nth-child(even){ background-color:#e0f7fa;}
#voiceHistory li:nth-child(odd){ background-color:#f1f8e9;}
#voiceHistory li{ padding:5px; border-radius:6px; margin-bottom:4px;}
canvas { border:1px solid #0096c7; border-radius:8px; margin-top:1rem;}
.motivation { color:green; font-weight:bold; margin-top:5px;}
</style>
</head>
<body>

<audio id="clickSound" src="sounds/click.mp3"></audio>
<audio id="successSound" src="sounds/success.mp3"></audio>
<audio id="voiceStartSound" src="sounds/voice.mp3"></audio>
<audio id="traceSound" src="sounds/trace.mp3"></audio>

<header>
<h1>‚úçÔ∏è ‡∂Ö‡∂ö‡∑î‡∂ª‡∑î ‡∂∏‡∑í‡∂≠‡∑î‡∂ª‡∑è</h1>
<p>‡∑É‡∑í‡∂Ç‡∑Ñ‡∂Ω ‡∂Ö‡∂ö‡∑î‡∂ª‡∑î, ‡∑Ä‡∂†‡∂± ‡∑É‡∑Ñ ‡∂ö‡∑ä‚Äç‡∂ª‡∑ì‡∂©‡∑è</p>
</header>

<nav>
<a href="#home">üè† ‡∂∏‡∑î‡∂Ω‡∑ä ‡∂¥‡∑í‡∂ß‡∑î‡∑Ä</a>
<a href="#activities">üî° ‡∂ö‡∑ä‚Äç‡∂ª‡∑í‡∂∫‡∑è‡∂ö‡∑è‡∂ª‡∂ö‡∂∏‡∑ä</a>
<a href="#games">üéÆ ‡∂ö‡∑ä‚Äç‡∂ª‡∑ì‡∂©‡∑è</a>
<a href="#howto">üìñ ‡∂∑‡∑è‡∑Ä‡∑í‡∂≠‡∑è ‡∂ö‡∂ª‡∂± ‡∂Ö‡∂∫‡∑î‡∂ª‡∑î</a>
<a href="#faq">‚ùì ‡∂¥‡∑ä‚Äç‡∂ª‡∑Å‡∑ä‡∂±</a>
<a href="#feedback">üìù ‡∂Ö‡∂Ø‡∑Ñ‡∑É‡∑ä</a>
<a href="#contact">üìû ‡∑É‡∂∏‡∑ä‡∂∂‡∂±‡∑ä‡∂∞ ‡∑Ä‡∑ì‡∂∏</a>
</nav>

<section id="home">
<h2>‡∂∏‡∑î‡∂Ω‡∑ä ‡∂¥‡∑í‡∂ß‡∑î‡∑Ä</h2>
<p><b>‡∂Ö‡∂ª‡∂∏‡∑î‡∂´:</b> "‡∂Ö‡∂ö‡∑î‡∂ª‡∑î ‡∂∏‡∑í‡∂≠‡∑î‡∂ª‡∑è" ‡∂∫‡∂±‡∑î <b>‡∂©‡∑í‡∑É‡∑ä‡∂ú‡∑ä‚Äç‡∂ª‡∑è‡∑Ü‡∑í‡∂∫‡∑è</b> ‡∂á‡∂≠‡∑í ‡∑É‡∑í‡∑É‡∑î‡∂±‡∑ä‡∂ß ‡∑É‡∑í‡∂Ç‡∑Ñ‡∂Ω ‡∂∑‡∑è‡∑Ç‡∑è‡∑Ä‡∑ô‡∂±‡∑ä ‡∂Ω‡∑í‡∑Ä‡∑ì‡∂∏ ‡∑É‡∑Ñ ‡∂ö‡∑í‡∂∫‡∑Ä‡∑ì‡∂∏‡∑ö‡∂Ø‡∑ì ‡∂¥‡∑Ñ‡∑É‡∑î‡∑Ä ‡∑É‡∂¥‡∂∫‡∂± ‡∂Ö‡∂©‡∑Ä‡∑í‡∂∫‡∂ö‡∑í.</p>
</section>

<section id="activities">
<h2>üî° ‡∂ö‡∑ä‚Äç‡∂ª‡∑í‡∂∫‡∑è‡∂ö‡∑è‡∂ª‡∂ö‡∂∏‡∑ä</h2>
<p>‡∑É‡∑í‡∂∫‡∂Ω‡∑î‡∂∏ ‡∑É‡∑í‡∂Ç‡∑Ñ‡∂Ω ‡∂Ö‡∂ö‡∑î‡∂ª‡∑î ‡∂Ö‡∂∑‡∑ä‚Äç‡∂∫‡∑è‡∑É ‡∂ö‡∂ª‡∂±‡∑ä‡∂±. ‡∂ö‡∑ä‡∂Ω‡∑í‡∂ö‡∑ä ‡∂ö‡∂Ω ‡∑Ä‡∑í‡∂ß ‡∂Ö‡∂ö‡∑î‡∂ª‡∑ö ‡∑Å‡∂∂‡∑ä‡∂Ø‡∂∫ ‡∂±‡∑í‡∂ö‡∑î‡∂≠‡∑ä ‡∑Ä‡∑ö.</p>
<div class="letters" id="lettersGrid"></div>
</section>

<section id="games">
<h2>üéÆ ‡∂ö‡∑ä‚Äç‡∂ª‡∑ì‡∂©‡∑è ‡∂¥‡∑î‡∑Ä‡∂ª‡∑î‡∑Ä</h2>
<div class="game-dashboard">

<div class="game-card">
<h3>‚úçÔ∏è ‡∂Ö‡∂ö‡∑î‡∂ª‡∑î ‡∂Ö‡∂≥‡∑í‡∂± ‡∂Ö‡∂∑‡∑í‡∂∫‡∑ù‡∂ú‡∂∫</h3>
<p>‡∂Ö‡∂ö‡∑î‡∂ª‡∑î ‡∂Ö‡∂∑‡∑ä‚Äç‡∂∫‡∑è‡∑É ‡∂ö‡∂ª‡∂∏‡∑í‡∂±‡∑ä ‡∂î‡∂∂‡∑ö ‡∑Ñ‡∑ê‡∂ö‡∑í‡∂∫‡∑è‡∑Ä ‡∑Ä‡∑ê‡∂©‡∑í ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</p>
<canvas id="traceCanvas" width="200" height="200"></canvas>
<button onclick="startTracing()">‡∂Ö‡∂ö‡∑î‡∂ª‡∂ö‡∑ä ‡∂Ö‡∂∑‡∑ä‚Äç‡∂∫‡∑è‡∑É ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</button>
<p class="motivation" id="traceMotivation"></p>
<p>‡∂Ö‡∂ö‡∑î‡∂ª‡∑î ‡∂±‡∑í‡∑Ä‡∑ê‡∂ª‡∂Ø‡∑í‡∑Ä ‡∂Ö‡∂≥‡∑í‡∂± ‡∑Ñ‡∑ê‡∂ö‡∑í‡∂∫‡∑è‡∑Ä: <span id="traceAccuracy">0</span>%</p>
</div>

<div class="game-card">
<h3>üé§ ‡∑Ä‡∑è‡∂´‡∑í‡∂¢‡∑è-‡∂¥‡∑ô‡∑Ö‡∂ß ‡∂¥‡∂ª‡∑í‡∑Ä‡∂ª‡∑ä‡∂≠‡∂±‡∂∫</h3>
<p>‡∂î‡∂∂‡∑ö ‡∂ö‡∂Æ‡∂±‡∂∫ ‡∑É‡∑í‡∂Ç‡∑Ñ‡∂Ω‡∂ß ‡∂¥‡∂ª‡∑í‡∑Ä‡∂ª‡∑ä‡∂≠‡∂±‡∂∫ ‡∑Ä‡∑ö</p>
<button onclick="startVoice()">‡∂ö‡∑í‡∂∫‡∂±‡∑ä‡∂±</button>
<p id="voiceResult">üéôÔ∏è ‡∂î‡∂∂‡∑ö ‡∂ö‡∂Æ‡∂±‡∂∫ ‡∂∏‡∑ô‡∂≠‡∂± ‡∂¥‡∑ô‡∂±‡∑ä‡∑Ä‡∑ô‡∂±‡∑î ‡∂á‡∂≠</p>
<h4>üìú ‡∂¥‡∂ª‡∑í‡∑Ä‡∂ª‡∑ä‡∂≠‡∂± ‡∂â‡∂≠‡∑í‡∑Ñ‡∑è‡∑É‡∂∫:</h4>
<ul id="voiceHistory"></ul>
<p class="motivation" id="voiceAccuracy">‡∑Ä‡∂†‡∂± ‡∂±‡∑í‡∑Ä‡∑ê‡∂ª‡∂Ø‡∑í‡∑Ä ‡∑Ñ‡∑ê‡∂≥‡∑í‡∂±‡∑ä‡∑Ä‡∑ì‡∂∏: 0%</p>
</div>

<div class="game-card">
<h3>üß† ‡∂∏‡∂≠‡∂ö ‡∂ö‡∑ä‚Äç‡∂ª‡∑ì‡∂©‡∑è‡∑Ä</h3>
<p>‡∂Ö‡∂ö‡∑î‡∂ª‡∑î ‡∂∏‡∂≠‡∂ö‡∂∫ ‡∑Ä‡∂ª‡∑ä‡∂∞‡∂±‡∂∫ ‡∂ö‡∂ª‡∂ú‡∂±‡∑ä‡∂±</p>
<div id="memoryGame"></div>
<button onclick="initMemoryGame()">‡∂Ü‡∂ª‡∂∏‡∑ä‡∂∑ ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</button>
<p class="motivation" id="memoryMotivation"></p>
<p>‡∂±‡∑í‡∑Ä‡∑ê‡∂ª‡∂Ø‡∑í ‡∂Ö‡∂±‡∑î‡∂¥‡∑í‡∑Ö‡∑í‡∑Ä‡∑ô‡∂Ω: <span id="memoryAccuracy">0</span>%</p>
</div>

<div class="game-card">
<h3>üìä ‡∑É‡∂∏‡∑É‡∑ä‡∂≠ ‡∂±‡∑í‡∑Ä‡∑ê‡∂ª‡∂Ø‡∑í‡∂∑‡∑è‡∑Ä‡∂∫</h3>
<p>‡∂î‡∂∂‡∑ö ‡∂ö‡∑ä‚Äç‡∂ª‡∑ì‡∂©‡∑è ‡∂±‡∑í‡∑Ä‡∑ê‡∂ª‡∂Ø‡∑í‡∂∑‡∑è‡∑Ä‡∂∫ ‡∂∏‡∑ô‡∂≠‡∂± ‡∂¥‡∑ô‡∂±‡∑ä‡∑Ä‡∂±‡∑î ‡∂á‡∂≠</p>
<p>‡∑É‡∂∏‡∑É‡∑ä‡∂≠ ‡∂±‡∑í‡∑Ä‡∑ê‡∂ª‡∂Ø‡∑í‡∂∑‡∑è‡∑Ä‡∂∫: <span id="overallAccuracy">0</span>%</p>
<button onclick="calculateOverall()">‡∂ú‡∂´‡∂±‡∂∫ ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</button>
</div>

</div>
</section>

<section id="howto" class="howto">
<h2>üìñ ‡∂∑‡∑è‡∑Ä‡∑í‡∂≠‡∑è ‡∂ö‡∂ª‡∂± ‡∂Ö‡∂∫‡∑î‡∂ª‡∑î</h2>
<ol>
<li>‡∂Ö‡∂ö‡∑î‡∂ª‡∑î ‡∂∏‡∂≠ ‡∂ö‡∑ä‡∂Ω‡∑í‡∂ö‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂± ‚Üí ‡∂Ö‡∂ö‡∑î‡∂ª ‡∂ö‡∑í‡∂∫‡∑Ä‡∂∫‡∑í.</li>
<li>‡∂Ö‡∂ö‡∑î‡∂ª‡∑î ‡∂Ö‡∂≥‡∑í‡∂± ‡∂Ö‡∂∑‡∑ä‚Äç‡∂∫‡∑è‡∑É‡∂∫ ‡∂∑‡∑è‡∑Ä‡∑í‡∂≠‡∑è ‡∂ö‡∂ª‡∂±‡∑ä‡∂±.</li>
<li>‡∂ö‡∑ä‚Äç‡∂ª‡∑ì‡∂©‡∑è ‡∂≠‡∑ù‡∂ª‡∑è ‚Üí ‡∂∏‡∂≠‡∂ö‡∂∫, ‡∂Ω‡∑í‡∑Ä‡∑ì‡∂∏ ‡∑É‡∑Ñ ‡∂á‡∑É‡∑ä ‡∂¥‡∑î‡∑Ñ‡∑î‡∂´‡∑î‡∑Ä ‡∂¥‡∑î‡∑Ñ‡∑î‡∂´‡∑î ‡∂ö‡∂ª‡∂±‡∑ä‡∂±.</li>
<li>‡∑Ä‡∑è‡∂´‡∑í‡∂¢‡∑è-‡∂¥‡∑ô‡∑Ö‡∂ß ‡∂¥‡∂ª‡∑í‡∑Ä‡∂ª‡∑ä‡∂≠‡∂±‡∂∫ ‚Üí ‡∂î‡∂∂‡∑ö ‡∂ö‡∂Æ‡∂±‡∂∫ ‡∑É‡∑í‡∂Ç‡∑Ñ‡∂Ω‡∂ß ‡∂¥‡∂ª‡∑í‡∑Ä‡∂ª‡∑ä‡∂≠‡∂±‡∂∫ ‡∂ö‡∂ª‡∂∫‡∑í.</li>
</ol>
</section>

<section id="faq" class="faq">
<h2>‚ùì ‡∂¥‡∑ä‚Äç‡∂ª‡∑Å‡∑ä‡∂±</h2>
<p><b>‡∂∏‡∂ú‡∑ö ‡∂Ø‡∂ª‡∑î‡∑Ä‡∑è‡∂ß ‡∂∏‡∑ö ‡∂Ö‡∂©‡∑Ä‡∑í‡∂∫‡∑ô‡∂±‡∑ä ‡∂ö‡∑î‡∂∏‡∂ö‡∑ä ‡∑É‡∑ú‡∂∫‡∑è‡∂ú‡∂≠ ‡∑Ñ‡∑ê‡∂ö?</b> ‡∂Ö‡∂ö‡∑î‡∂ª‡∑î ‡∑Ñ‡∂≥‡∑î‡∂±‡∑è‡∂ú‡∑ê‡∂±‡∑ì‡∂∏, ‡∂Ö‡∂ö‡∑î‡∂ª‡∑î ‡∂Ö‡∂≥‡∑í‡∂± ‡∂Ö‡∂∑‡∑ä‚Äç‡∂∫‡∑è‡∑É, ‡∂∏‡∂≠‡∂ö ‡∂ö‡∑ä‚Äç‡∂ª‡∑ì‡∂©‡∑è, ‡∑Ä‡∑è‡∂´‡∑í‡∂¢‡∑è-‡∂¥‡∑ô‡∑Ö‡∂ß ‡∂¥‡∂ª‡∑í‡∑Ä‡∂ª‡∑ä‡∂≠‡∂±‡∂∫.</p>
</section>

<section id="feedback" class="feedback">
<h2>üìù ‡∂Ö‡∂Ø‡∑Ñ‡∑É‡∑ä</h2>
<form id="feedbackForm">
<label>‡∂±‡∂∏:</label><input type="text" id="name" required>
<label>‡∂ä‡∂∏‡∑ö‡∂Ω‡∑ä:</label><input type="email" id="email" required>
<label>‡∂Ö‡∂Ø‡∑Ñ‡∑É‡∑ä:</label><textarea id="message" rows="4" required></textarea>
<button type="submit">‡∂∫‡∑Ä‡∂±‡∑ä‡∂±</button>
</form>
<p id="feedbackMsg" style="color:green; font-weight:bold;"></p>
</section>

<section id="contact">
<h2>üìû ‡∑É‡∂∏‡∑ä‡∂∂‡∂±‡∑ä‡∂∞ ‡∑Ä‡∑ì‡∂∏</h2>
<p>üìû 070 422 6267</p>
<p>‚úâÔ∏è support@writeease.lk</p>
</section>

<footer>
<p>¬© 2025 ‡∂Ö‡∂ö‡∑î‡∂ª‡∑î ‡∂∏‡∑í‡∂≠‡∑î‡∂ª‡∑è | ‡∑Ö‡∂∏‡∑î‡∂±‡∑ä ‡∑É‡∂≥‡∑Ñ‡∑è ‡∑Ñ‡∑í‡∂≠‡∂ö‡∑è‡∂∏‡∑ì ‡∂Ö‡∂∞‡∑ä‚Äç‡∂∫‡∑è‡∂¥‡∂±‡∑í‡∂ö ‡∂Ö‡∂©‡∑Ä‡∑í‡∂∫</p>
</footer>

<script>
// Sinhala letters
const sinhalaLetters=["‡∂Ö","‡∂Ü","‡∂á","‡∂à","‡∂â","‡∂ä","‡∂ã","‡∂å","‡∂ç","‡∂é","‡∂è","‡∂ê","‡∂ë","‡∂í","‡∂ì","‡∂î","‡∂ï","‡∂ñ","‡∂ö","‡∂õ","‡∂ú","‡∂ù","‡∂û","‡∂ü","‡∂†","‡∂°","‡∂¢","‡∂£","‡∂§","‡∂•","‡∂ß","‡∂®","‡∂©","‡∂™","‡∂´","‡∂¨","‡∂≠","‡∂Æ","‡∂Ø","‡∂∞","‡∂±","‡∂≥","‡∂¥","‡∂µ","‡∂∂","‡∂∑","‡∂∏","‡∂π","‡∂∫","‡∂ª","‡∂Ω","‡∑Ä","‡∑Å","‡∑Ç","‡∑É","‡∑Ñ","‡∑Ö","‡∑Ü"];
const lettersGrid=document.getElementById("lettersGrid");

// Sounds
const clickSound=document.getElementById("clickSound");
const successSound=document.getElementById("successSound");
const voiceStartSound=document.getElementById("voiceStartSound");
const traceSound=document.getElementById("traceSound");

// Letters grid with TTS + click sound fix
sinhalaLetters.forEach(l=>{
  const div=document.createElement("div");
  div.className="letter"; div.textContent=l;
  div.onclick=()=>{
    clickSound.currentTime=0;
    clickSound.play();
    setTimeout(()=>speech(l),100); // delay ensures sound plays before TTS
  };
  lettersGrid.appendChild(div);
});

function speech(txt){
  const utter=new SpeechSynthesisUtterance(txt);
  utter.lang="si-LK"; speechSynthesis.speak(utter);
}

// Tracing Game
let traceCanvas=document.getElementById("traceCanvas");
let ctx=traceCanvas.getContext("2d");
let currentLetterIndex=0;
let traceDrawn=false;
let traceAttempts=0, traceCorrect=0;

function startTracing(){
  ctx.clearRect(0,0,traceCanvas.width,traceCanvas.height);
  traceDrawn=false;
  let letter=sinhalaLetters[currentLetterIndex];
  ctx.font="100px Noto Sans Sinhala";
  ctx.fillStyle="#e0e0e0";
  ctx.fillText(letter,50,150);

  traceCanvas.onmousedown=function(e){
    traceDrawn=true;
    ctx.strokeStyle="#0096c7";
    ctx.lineWidth=6;
    ctx.beginPath();
    ctx.moveTo(e.offsetX,e.offsetY);
    traceCanvas.onmousemove=function(e){
      ctx.lineTo(e.offsetX,e.offsetY);
      ctx.stroke();
    }
  }
  traceCanvas.onmouseup=function(e){
    ctx.closePath(); ctx.onmousemove=null;
    traceAttempts++;
    if(traceDrawn){ traceCorrect++; document.getElementById("traceMotivation").innerText="‡∑Ñ‡∑ú‡∂≥‡∂∫‡∑í! üëè"; }
    else{ document.getElementById("traceMotivation").innerText="‡∂±‡∑ê‡∑Ä‡∂≠ ‡∂ã‡∂≠‡∑ä‡∑É‡∑è‡∑Ñ ‡∂ö‡∂ª‡∂±‡∑ä‡∂±!"; }
    let acc=Math.round((traceCorrect/traceAttempts)*100);
    document.getElementById("traceAccuracy").innerText=acc;
    currentLetterIndex=(currentLetterIndex+1)%sinhalaLetters.length;
  }
}

// Memory Game
function initMemoryGame(){
  const game=document.getElementById("memoryGame");
  game.innerHTML="";
  const pairs=["‡∂Ö","‡∂Ü","‡∂ö","‡∂ú","‡∂≠","‡∂Ø"];
  let cards=[...pairs,...pairs].sort(()=>0.5-Math.random());
  let flipped=[], matched=0, attempts=0;
  cards.forEach(letter=>{
    const div=document.createElement("div");
    div.className="card";
    div.dataset.letter=letter;
    div.textContent="‚ùì";
    div.style.cssText="font-size:2rem;height:80px;display:flex;align-items:center;justify-content:center;border-radius:10px;background:#0096c7;color:white;cursor:pointer;margin:5px;";
    div.onclick=function(){
      if(flipped.length<2 && !div.classList.contains("flipped")){
        div.classList.add("flipped"); div.textContent=letter;
        flipped.push(div);
        if(flipped.length===2){
          attempts++;
          if(flipped[0].dataset.letter===flipped[1].dataset.letter){
            successSound.play(); matched++;
            document.getElementById("memoryMotivation").innerText="‡∑Ñ‡∑ú‡∂≥‡∂∫‡∑í! üëè";
            flipped=[]; 
          }else{
            setTimeout(()=>{ flipped.forEach(c=>{c.classList.remove("flipped"); c.textContent="‚ùì";}); flipped=[]; },800);
          }
          let acc=Math.round((matched/attempts)*100);
          if(isNaN(acc)) acc=0;
          document.getElementById("memoryAccuracy").innerText=acc;
        }
      }
    }
    game.appendChild(div);
  });
}

// Voice Recognition
function startVoice(){
  voiceStartSound.play();
  if(!('webkitSpeechRecognition' in window)){ alert("‡∂∏‡∑ô‡∂∏ Browser Voice Recognition ‡∑É‡∂¥‡∂∫‡∂±‡∑ä‡∂±‡∑ö ‡∂±‡∑ê‡∂≠."); return; }
  const recog=new webkitSpeechRecognition();
  recog.lang="si-LK"; recog.continuous=false; recog.interimResults=false;
  recog.onresult=e=>{
    let transcript=e.results[0][0].transcript;
    document.getElementById("voiceResult").textContent="‚û°Ô∏è "+transcript;
    const li=document.createElement("li"); li.textContent=transcript;
    document.getElementById("voiceHistory").appendChild(li);

    // simple accuracy: fraction of letters spoken correctly from Sinhala letters
    let correct=0;
    for(let i=0;i<transcript.length;i++){ if(sinhalaLetters.includes(transcript[i])) correct++; }
    let acc=Math.round((correct/transcript.length)*100);
    document.getElementById("voiceAccuracy").innerText="‡∑Ä‡∂†‡∂± ‡∂±‡∑í‡∑Ä‡∑ê‡∂ª‡∂Ø‡∑í‡∑Ä ‡∑Ñ‡∑ê‡∂≥‡∑í‡∂±‡∑ä‡∑Ä‡∑ì‡∂∏: "+acc+"%";
  }
  recog.start();
}

// Overall Accuracy
function calculateOverall(){
  let traceAcc=parseInt(document.getElementById("traceAccuracy").innerText)||0;
  let memoryAcc=parseInt(document.getElementById("memoryAccuracy").innerText)||0;
  let voiceAcc=parseInt(document.getElementById("voiceAccuracy").innerText.replace(/\D/g,''))||0;
  let overall=Math.round((traceAcc+memoryAcc+voiceAcc)/3);
  document.getElementById("overallAccuracy").innerText=overall;
}

// Feedback Form
document.getElementById("feedbackForm").addEventListener("submit",function(e){
  e.preventDefault();
  document.getElementById("feedbackMsg").innerText="‚úÖ ‡∂î‡∂∂‡∑ö ‡∂Ö‡∂Ø‡∑Ñ‡∑É‡∑ä ‡∂Ö‡∂¥‡∂ß ‡∂Ω‡∑ê‡∂∂‡∑ì ‡∂á‡∂≠!";
  this.reset();
});
</script>
</body>
</html>
